<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1.1, user-scalable=no"/>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <style type="text/css">
        html {
            height: 100%
        }

        body {
            height: 100%;
            margin: 0px;
            padding: 0px
        }

        #main {
            height: 100%
        }
    </style>
    <script type="text/javascript" src="http://webapi.amap.com/maps?v=1.2&key=6d095d1e079ad505e947d709d9389cc1">
    </script>
    <script type="text/javascript" async="" src="js/getdata.js"></script>
    <script type="text/javascript">
        function initialize() {
            var position = new AMap.LngLat(116.404, 39.915);//创建中心点坐标
            var mapObj = new AMap.Map("map_container", {center: position});//创建地图实例
            var marker = new AMap.Marker({
                map: mapObj,
                position: new AMap.LngLat(116.406326, 39.903942),
                offset: new AMap.Pixel(-10, -34),
                icon: "http://webapi.amap.com/images/0.png"
            });// 自定义构造AMap.Marker对象

            mapObj.plugin(["AMap.ToolBar","AMap.OverView","AMap.Scale"],function()
            {
                toolbar = new AMap.ToolBar();
                toolbar.autoPosition=false; //加载工具条
                mapObj.addControl(toolbar);
                overview = new AMap.OverView(); //加载鹰眼
                mapObj.addControl(overview);
                scale = new AMap.Scale(); //加载比例尺
                mapObj.addControl(scale);
            });

            listener=AMap.event.addListener(mapObj,'click',fn);




            showUser();
        }

        function fn(e){
            document.getElementById("txt_x").value=e.lnglat.getLng();
            document.getElementById("txt_y").value=e.lnglat.getLat();
        }


        function JSON_test(o) {
            var user = {
                name: document.getElementById('txt_name').value,
                address: document.getElementById('txt_address').value,
                x: document.getElementById('txt_x').value,
                y: document.getElementById('txt_y').value,
                phone: document.getElementById('txt_phone').value,
                description: document.getElementById('txt_description').value
            }
            var json_string = JSON.stringify(user);
            document.getElementById('txt_json').value = json_string;
            alert("点击确定后将提交表单");
            o.submit();
        }

    </script>
    <title>Healthy Consultant</title></head>
<body onload="initialize()">
<!--<script src='greeter.js'></script>-->
<div id="main">
    <div id="main_left" style=" display: block; background: white">
        <form id="form1" name="form1" method="post" action="php/insertdata.php"
              onsubmit="JSON_test(this);return flase;" style="margin-left: 50px;margin-top: 20px" >
            <label for="txt_name">机构名称</label>

            <p><input type="text" name="txt_name" id="txt_name"/></p>
            <label for="txt_address">地址</label>

            <p><input type="text" name="txt_address" id="txt_address"/></p>

            <p><label for="txt_phone">电话</label></p>

            <p><input type="text" name="txt_phone" id="txt_phone"/></p>

            <p><label for="txt_x">x坐标</label></p>

            <p><input type="text" name="txt_x" id="txt_x"/></p>

            <p><label for="txt_y">y坐标</label></p>

            <p><input type="text" name="txt_y" id="txt_y"/></p>

            <p><label for="txt_description">描述</label></p>

            <p><input type="text" name="txt_description" id="txt_description"/></p>

            <p><input type="text" name="txt_json" id="txt_json"/>
                <label for="button"></label>
                <input type="submit" name="button" id="button" value="JSON"/>
            </p>
        </form>
        <span id="age_text">111</span>
    </div>
    <div id="map_container" style="width: 1048px; margin-left: 330px;"></div>
</div>

</body>
</html>